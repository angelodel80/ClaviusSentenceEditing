package it.cnr.ilc.clavius.utils;

import org.jdom2.Document;
import org.jdom2.output.Format;
import org.jdom2.output.XMLOutputter;
import org.xmldb.api.DatabaseManager;
import org.xmldb.api.base.Collection;
import org.xmldb.api.base.Database;
import org.xmldb.api.base.XMLDBException;
import org.xmldb.api.modules.XMLResource;

public class ExistConnection {

	private String context;

	protected final String driver = "org.exist.xmldb.DatabaseImpl";
	protected final String collection = "xmldb:exist://localhost:8080/exist/xmlrpc/db/claviusTemplate/";
	private Collection connectionAccessPoint = null;

	public ExistConnection() {
		// TODO Auto-generated constructor stub
	}

	public ExistConnection(String context) {
		this.context = context;
	}

	public boolean connect() {
		boolean ret = false;

		try {

			Class<?> c = Class.forName(driver);
			Database db = (Database) c.newInstance();
			DatabaseManager.registerDatabase(db);
			setConnectionAccessPoint(DatabaseManager.getCollection(collection,
					"admin", "angelodel80"));
			ret = true;
			// System.err.println(root.getName());

			// String[] resources = root.listResources();
			// for(String res: resources){
			// System.out.println(res);
			// }

		} catch (XMLDBException eXML) {
			eXML.printStackTrace();
		} catch (ClassNotFoundException eRefl) {
			// TODO Auto-generated catch block
			eRefl.printStackTrace();
		} catch (InstantiationException eInst) {
			// TODO Auto-generated catch block
			eInst.printStackTrace();
		} catch (IllegalAccessException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return ret;
	}

	public Collection getConnectionAccessPoint() {
		return connectionAccessPoint;
	}

	public void setConnectionAccessPoint(Collection connectionAccessPoint) {
		this.connectionAccessPoint = connectionAccessPoint;
	}
	
}
